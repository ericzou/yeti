<% page_title "Create a new list, Yeti - the best way to share and discover lists" %>
<% body_id "new" %>
<% body_class "list" %>

<% left_panel_nav("create-new-list") %>

<% content_for :left_panel_content do %>
  <%= render 'form' %>
<% end %>

<% content_for :right_panel_content do %>
  <%= render :partial => 'list_meta' %>
  <ul class="list-items">
    <li class="list-item">
      <span class="list-style numbered">1</span>
      <span class="list-item-input">
        <input type="textfield", class="form-textfield very-long short-height" id="list_list_items_attributes_0_body_source">
      </span>
      <%= floating_explanation(@list, "list_items.body", "Enter something") %>
      <span class="list-item-body"></span>
    </li>      
    <li class="list-item last">
      <span class="list-style numbered">2</span>
      <span class="list-item-input">
        <input type="textfield", class="form-textfield very-long short-height" id="">
      </span>
      <span class="list-item-body">
        click here to add more
      </span>
    </li>
  </ul>
  <script type="text/javascript">
  
    $('.field_with_errors input').livequery("blur", function(){
      if ($(this).val() !== ""){          $(this).parents(".field_with_errors").next('.floating-explanation').fadeOut();
      }
    });
    
    $('.list-item .field_with_errors input').livequery("blur", function(){
      if ($(this).val() !== ""){          $(this).parents(".list-item").find('.floating-explanation').fadeOut();
      }
    });
    
    $('#list_title').delayedObserver(0.5, function(){
      $('h3.list-title').html($('#list_title').val());
    }, { event : 'keyup'} );
    
    $('#list_description').delayedObserver(0.5, function(){
      $('.description').html($('#list_description').val());
    }, { event : 'keyup'} );
    
    
    $('.list-item-input input').livequery("keyup", function(){
      $(this).parents(".list-item").find(".list-item-body").html($(this).val());
      linked_input_id = $(this).attr("id").replace(/_source/, "");
      $("#"+linked_input_id).val($(this).val());
    });
    
    $('.list-item-input input').livequery("blur", function(){
      if (Yeti.isEmpty($(this).val()) ){
        return
      };
      $(this).parents(".list-item-input").hide();
      $(this).parents(".list-item").find(".list-item-body").show();
    });

    $('.list-item-body').livequery("click", function(){
      $(this).hide();
      $(this).parents(".list-item").find(".list-item-input").show();
      $(this).parents(".list-item").find(".list-item-input input").focus();
    });
    
    $('.list-item.last').livequery("click", function(){
      Yeti.clone_list_item(this);
    });
    
  </script>
<% end %>
